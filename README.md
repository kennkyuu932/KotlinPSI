# KotlinPSI

AndroidでBoringSSLを用いてPSIを行うアプリ

今後の実装

・二者間で通信して共通要素を求める．

・ダミーの接触履歴の共通要素を求める．

2023/11/16

PSIを計算するときにroomから取り出した集合を暗号化できるようにした．

roomから取り出した"yyyy-MM-dd'T'HH:mm"のLocalDateTime型のdate要素をtoString()でStringにしてnativeC++に渡している．

実際にC++側に渡すメッセージはContact(date=2023-11-16T13:06, name=44)のような形になる．

roomの構成を変更．

AsyncTaskを使って操作していたが，lifecyclescopeなどを使用してroomを操作することができるようになった．

非推奨だったAsynkTaskを使わなくなり，Coroutineを使うようになった．

roomの変更に伴い，ContactRepository.ktとContactApplication.ktを追加

2023/11/07

roomのデータベースを操作したときに操作の内容に応じてトーストを表示させるようにした．

2023/11/06

鍵生成，メッセージ暗号化を分けて書くようにした．

鍵生成はおそらく出来ていて，その鍵を使用してメッセージの暗号化も出来ていると思う．

出来ていない部分として暗号化したメッセージをKotlinに持ってくるところである．

jbyteArrayの取り扱いが難しいため，集合の要素数分メッセージ暗号化関数を呼び出す方式になる可能性が高い．

2023/11/01

データベースに格納する日時を日付と時間に分割して文字列として格納する状態から，LocalDateTime型で格納するように変更．

RoomでLocalDateTimeを使用可能にするためにContactConverter.ktファイルを追加．

手動でデータを入力する際はDatePicker,TimePickerを使用している．

プログラム上ではDatePickerのほうが先に記述しているが，TimePickerのほうが先に起動するため，それぞれで`editdatetext.setText()`を行っている．(スレッドなどの問題?)

データベースに格納する際にtry-catchを行うようにした．

データベースに格納できなかった時にToastを表示しようと考えたが，Toastはメインスレッドで動かす必要があったため断念．
(データベース操作に関するフラグを付けてメインスレッド上でToastを実行しようとしたが，複数スレッドでフラグを操作すると同期の問題でうまくいかなかったため放置)

2023/10/27

サーバで暗号化したデータを送信する部分で苦しんでいる．

C++で暗号化したデータをkotlinに持っていくときにjbyteやらjbytearrayなどに直さないと持っていけない可能性がある？

2023/10/17

Roomを用いたデータベースを扱えるようにした．

手動で3つの文字列型データ(`date:String,time:String,name:String`)の追加，
データの削除ができるようになった．

(コルーチンがよくわからなかったためAsyncTask.executeを使用した．)

2023/10/16

通信を行うために`EC_POINT`型のデータをバイナリ形式(`unsigned char *`)に変更可能にした．

バイナリ形式のデータを`EC_POINT`型に変換できるようにした．

2023/10/12

二者間通信を実装する初期段階

2023/10/10

あらかじめ指定した文字列に対して共通要素を求めることができた．
